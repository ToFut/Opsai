{
  "AWSTemplateFormatVersion": "2010-09-09",
  "Description": "CloudFormation template for TechCorp Platform",
  "Parameters": {
    "EnvironmentName": {
      "Type": "String",
      "Default": "production",
      "Description": "Environment name"
    }
  },
  "Resources": {
    "VPC": {
      "Type": "AWS::EC2::VPC",
      "Properties": {
        "CidrBlock": "10.0.0.0/16",
        "EnableDnsHostnames": true,
        "EnableDnsSupport": true
      }
    },
    "ECSCluster": {
      "Type": "AWS::ECS::Cluster",
      "Properties": {
        "ClusterName": "techcorp-platform-cluster"
      }
    },
    "TaskDefinition": {
      "Type": "AWS::ECS::TaskDefinition",
      "Properties": {
        "Family": "techcorp-platform-task",
        "NetworkMode": "awsvpc",
        "RequiresCompatibilities": [
          "FARGATE"
        ],
        "Cpu": 256,
        "Memory": 512,
        "ContainerDefinitions": [
          {
            "Name": "techcorp-platform",
            "Image": "techcorp-platform:latest",
            "PortMappings": [
              {
                "ContainerPort": 3000,
                "Protocol": "tcp"
              }
            ],
            "Environment": [
              {
                "Name": "NODE_ENV",
                "Value": "production"
              },
              {
                "Name": "PORT",
                "Value": "3000"
              },
              {
                "Name": "DATABASE_URL",
                "Value": "${DATABASE_URL}"
              },
              {
                "Name": "JWT_SECRET",
                "Value": "${JWT_SECRET}"
              }
            ]
          }
        ]
      }
    },
    "RDSInstance": {
      "Type": "AWS::RDS::DBInstance",
      "Properties": {
        "DBInstanceIdentifier": "techcorp-platform-db",
        "DBInstanceClass": "db.t3.micro",
        "Engine": "postgres",
        "MasterUsername": "postgres",
        "MasterUserPassword": "!Ref DatabasePassword",
        "AllocatedStorage": 20
      }
    }
  }
}